# Malware Download Detection
# Detects downloads of potentially malicious files

detection:
  name: Suspicious File Download
  description: Detects downloads of executable files or files from suspicious URLs
  severity: high
  category: execution
  technique: T1204.002 - User Execution: Malicious File
  
  selection:
    - cowrie.eventid: 'cowrie.session.file_download'
    - cowrie.url|contains:
      - '.exe'
      - '.dll'
      - '.sh'
      - '.bin'
      - 'pastebin'
      - 'githubusercontent'
      - 'transfer.sh'
  
  timeframe: 5m
  condition: selection

  falsepositives:
    - Legitimate software downloads
    - System updates
  
  level: high

alert:
  - elasticsearch
  - email

elasticsearch:
  index: cowrie-*
  
email:
  to: security@example.com
  subject: "SIEM Alert: Suspicious File Download Detected"
